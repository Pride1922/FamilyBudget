<div class="app-container">
  <div class="register-container mat-elevation-z2">
    <h2>{{ 'REGISTRATION.TITLE' | translate }}</h2>
    <form [formGroup]="registrationForm" (ngSubmit)="register()">
      <!-- Hidden Field to Store Email -->
      <input type="hidden" formControlName="email" />

      <!-- Email Field (Visible but Disabled) -->
      <mat-form-field appearance="fill">
        <mat-label>{{ 'REGISTRATION.EMAIL' | translate }}</mat-label>
        <input
          matInput
          formControlName="email"
          type="email"
          placeholder="{{ 'REGISTRATION.EMAIL_PLACEHOLDER' | translate }}"
          readonly
        />
        <mat-error
          *ngIf="
            registrationForm.get('email')?.hasError('required') &&
            (registrationForm.get('email')?.touched ||
              registrationForm.get('email')?.dirty)
          "
        >
          {{ 'REGISTRATION.EMAIL_REQUIRED' | translate }}
        </mat-error>
        <mat-error
          *ngIf="
            registrationForm.get('email')?.hasError('email') &&
            (registrationForm.get('email')?.touched ||
              registrationForm.get('email')?.dirty)
          "
        >
          {{ 'REGISTRATION.EMAIL_INVALID' | translate }}
        </mat-error>
      </mat-form-field>

      <!-- Username Field -->
      <mat-form-field appearance="fill">
        <mat-label>{{ 'REGISTRATION.USERNAME' | translate }}</mat-label>
        <input
          matInput
          formControlName="username"
          type="text"
          placeholder="{{ 'REGISTRATION.USERNAME_PLACEHOLDER' | translate }}"
          required
          minlength="4"
          maxlength="20"
        />
        <mat-error
          *ngIf="
            registrationForm.get('username')?.hasError('required') &&
            (registrationForm.get('username')?.touched ||
              registrationForm.get('username')?.dirty)
          "
        >
          {{ 'REGISTRATION.USERNAME_REQUIRED' | translate }}
        </mat-error>
        <mat-error
          *ngIf="
            registrationForm.get('username')?.hasError('minlength') &&
            (registrationForm.get('username')?.touched ||
              registrationForm.get('username')?.dirty)
          "
        >
          {{ 'REGISTRATION.USERNAME_MINLENGTH' | translate }}
        </mat-error>
        <mat-error
          *ngIf="
            registrationForm.get('username')?.hasError('maxlength') &&
            (registrationForm.get('username')?.touched ||
              registrationForm.get('username')?.dirty)
          "
        >
          {{ 'REGISTRATION.USERNAME_MAXLENGTH' | translate }}
        </mat-error>
      </mat-form-field>

      <!-- Password Field -->
      <mat-form-field appearance="fill">
        <mat-label>{{ 'REGISTRATION.PASSWORD' | translate }}</mat-label>
        <input
          matInput
          formControlName="password"
          [type]="hidePassword ? 'password' : 'text'"
          placeholder="{{ 'REGISTRATION.PASSWORD_PLACEHOLDER' | translate }}"
          required
          minlength="6"
          maxlength="20"
        />
        <mat-error
          *ngIf="
            registrationForm.get('password')?.hasError('required') &&
            (registrationForm.get('password')?.touched ||
              registrationForm.get('password')?.dirty)
          "
        >
          {{ 'REGISTRATION.PASSWORD_REQUIRED' | translate }}
        </mat-error>
        <mat-error
          *ngIf="
            registrationForm.get('password')?.hasError('minlength') &&
            (registrationForm.get('password')?.touched ||
              registrationForm.get('password')?.dirty)
          "
        >
          {{ 'REGISTRATION.PASSWORD_MINLENGTH' | translate }}
        </mat-error>
        <mat-error
          *ngIf="
            registrationForm.get('password')?.hasError('maxlength') &&
            (registrationForm.get('password')?.touched ||
              registrationForm.get('password')?.dirty)
          "
        >
          {{ 'REGISTRATION.PASSWORD_MAXLENGTH' | translate }}
        </mat-error>
        <button
          mat-icon-button
          type="button"
          (click)="togglePasswordVisibility('password')"
          matSuffix
        >
          <mat-icon>{{
            hidePassword ? "visibility_off" : "visibility"
          }}</mat-icon>
        </button>
      </mat-form-field>

      <!-- Confirm Password Field -->
      <mat-form-field appearance="fill">
        <mat-label>{{ 'REGISTRATION.CONFIRM_PASSWORD' | translate }}</mat-label>
        <input
          matInput
          formControlName="confirmPassword"
          [type]="hideConfirmPassword ? 'password' : 'text'"
          placeholder="{{ 'REGISTRATION.CONFIRM_PASSWORD_PLACEHOLDER' | translate }}"
          required
        />
        <mat-error
          *ngIf="
            registrationForm.hasError('mismatch') &&
            (registrationForm.get('confirmPassword')?.touched ||
              registrationForm.get('confirmPassword')?.dirty)
          "
        >
          {{ 'REGISTRATION.PASSWORD_MISMATCH' | translate }}
        </mat-error>
        <button
          mat-icon-button
          type="button"
          (click)="togglePasswordVisibility('confirmPassword')"
          matSuffix
        >
          <mat-icon>{{
            hideConfirmPassword ? "visibility_off" : "visibility"
          }}</mat-icon>
        </button>
      </mat-form-field>

      <!-- Register Button -->
      <button
        mat-raised-button
        color="primary"
        type="submit"
        class="full-width"
        [disabled]="registrationForm.invalid"
      >
        {{ 'REGISTRATION.REGISTER_BUTTON' | translate }}
      </button>

      <!-- Error and Success Messages -->
      <div *ngIf="errorMessage" class="error-message mat-body-2">
        {{ errorMessage }}
      </div>
      <div *ngIf="successMessage" class="success-message mat-body-2">
        {{ successMessage }}
      </div>
    </form>
  </div>
</div>
